%% QUESTINO #2 
clear all; close all; clc

a = -5:0.01:5  ; 

x = (a + a.*sqrt(32*a.^2 + 33)) ./ (8*a.^2 + 8) ;

y = (1 + sqrt(32*a.^2 + 33)) ./ (8*a.^2 + 8)  ; 

f = (a.*x + y - 1/4).*exp(-x.^2 - y.^2) ; 

% For the POSITIVE x and y 
% Plot f vs a 
figure(1)
plot(a, f)
xlabel('a')
ylabel('Minimum of f')
title('Minimum of f as a function of a')

% Plot x vs a 
figure(2)
plot(a, x)
xlabel('a')
ylabel('x')
title('x vs a')

% Plot y vs a 
figure(3)
plot(a, y)
xlabel('a')
ylabel('y')
title('y vs a')


x_neg = (a - a.*sqrt(32*a.^2 + 33)) ./ (8*a.^2 + 8) ;

y_neg = (1 - sqrt(32*a.^2 + 33)) ./ (8*a.^2 + 8)  ; 

f_neg = (a.*x_neg + y_neg - 1/4).*exp(-x_neg.^2 - y_neg.^2) ; 

% For the NEGATIVE x and y 
% Plot f vs a 
figure(4)
plot(a, f_neg)
xlabel('a')
ylabel('Minimum of f')
title('Minimum of f as a function of a')

% Plot x vs a 
figure(5)
plot(a, x_neg)
xlabel('a')
ylabel('x')
title('x vs a')

% Plot y vs a 
figure(6)
plot(a, y_neg)
xlabel('a')
ylabel('y')
title('y vs a')

%% part 3
syms a
x = (a - a.*sqrt(32*a.^2 + 33)) ./ (8*a.^2 + 8);
dxda = diff(x,a);

sx = (a/x)*dxda

%
syms y
y = (1 + sqrt(32*a.^2 + 33)) ./ (8*a.^2 + 8); 
dyda = diff(y);

syms f
sy = (y/a)*dyda;

x = (a + a.*sqrt(32*a.^2 + 33)) ./ (8*a.^2 + 8);
y = (1 + sqrt(32*a.^2 + 33)) ./ (8*a.^2 + 8); 
f = (a.*x + y - 1/4).*exp(-x.^2 - y.^2);

dfda = diff(f);
 
sf = (f/a)*dfda

%%
% a,y(a)
a = -5:0.1:5;
f = @(a) -(a.*(8.*a.^2 + 8).*(((32.*a.^2 + 33).^(1/2) + (32.*a.^2)./(32.*a.^2 + 33).^(1/2) - 1)./(8.*a.^2 + 8) + (16.*a.*(a - a.*(32.*a.^2 + 33).^(1/2)))./(8.*a.^2 + 8).^2))./(a - a.*(32.*a.^2 + 33).^(1/2));
fa = f(a);
plot(a,fa,'-')

%%
% a,x(a)
syms a
y_neg = (1 - sqrt(32*a.^2 + 33)) ./ (8*a.^2 + 8)  ;
dyda = diff(y_neg, a)
S_yneg = dyda * (a ./ y_neg)
a = -5:0.1:5;
f = @(a) (a.*(8.*a.^2 + 8).*((32.*a)./((8.*a.^2 + 8).*(32.*a.^2 + 33).^(1/2)) - (16.*a.*((32.*a.^2 + 33).^(1/2) - 1))./(8.*a.^2 + 8).^2))./((32.*a.^2 + 33).^(1/2) - 1) ;
fa = f(a);
plot(a,fa,'-')

%%
% a,f(a)
syms a
x = (a - a.*sqrt(32*a.^2 + 33)) ./ (8*a.^2 + 8);
dxda = diff(x,a);

sx = (a/x)*dxda;

%
syms y
y = (1 + sqrt(32*a.^2 + 33)) ./ (8*a.^2 + 8); 
dyda = diff(y);

syms f
sy = (y/a)*dyda;

x = (a + a.*sqrt(32*a.^2 + 33)) ./ (8*a.^2 + 8);
y = (1 + sqrt(32*a.^2 + 33)) ./ (8*a.^2 + 8); 
f = (a.*x + y - 1/4).*exp(-x.^2 - y.^2);

dfda = diff(f);
 
sf = (f/a)*dfda
%%
%a,f(a)
x = -5:0.1:5;
% f = @(a) (exp(- ((32.*a.^2 + 33).^(1/2) + 1).^2/(8.*a.^2 + 8).^2 - (a + a.*(32.*a.^2 + 33).^(1/2)).^2./(8.*a.^2 + 8).^2).*(exp(- ((32.*a.^2 + 33).^(1/2) + 1).^2./(8.*a.^2 + 8).^2 - (a + a.*(32.*a.^2 + 33).^(1/2)).^2./(8.*a.^2 + 8).^2).*((32.*a)./((8.*a.^2 + 8).*(32.*a.^2 + 33).^0.5000) + (a + a.*(32.*a.^2 + 33).^(1/2))./(8.*a.^2 + 8) - (16.*a.^2.*(a + a.*(32.*a.^2 + 33).^(1/2)))./(8.*a.^2 + 8).^2 + (a.*((32.*a.^2)./(32.*a.^2 + 33).^0.5000 + (32.*a.^2 + 33).^(1/2) + 1))./(8.*a.^2 + 8) - (16.*a*((32.*a.^2 + 33).^(1/2) + 1))./(8.*a.^2 + 8).^2) + exp(- ((32.*a.^2 + 33).^(1/2) + 1).^2./(8.*a.^2 + 8).^2 - (a + a.*(32.*a.^2 + 33).^(1/2)).^2./(8.*a.^2 + 8).^2).*(((32.*a.^2 + 33).^(1/2) + 1)./(8.*a.^2 + 8) + (a.*(a + a.*(32.*a.^2 + 33).^(1/2)))./(8.*a.^2 + 8) - 0.2500).*((32.*a.*((32.*a.^2 + 33).^(1/2) + 1).^2)./(8.*a.^2 + 8).^3 + (32.*a.*(a + a.*(32.*a.^2 + 33).^(1/2)).^2)./(8.*a.^2 + 8).^3 - (2.*(a + a.*(32.*a.^2 + 33).^(1/2)).*((32.*a.^2)./(32.*a.^2 + 33).^0.5000 + (32.*a.^2 + 33).^(1/2) + 1))./(8.*a.^2 + 8).^2 - (64.*a.*((32.*a.^2 + 33).^(1/2) + 1))./((8.*a.^2 + 8).^2.*(32.*a.^2 + 33).^0.5000))).*(((32.*a.^2 + 33).^(1/2) + 1)./(8.*a.^2 + 8) + (a.*(a + a.*(32.*a.^2 + 33).^(1/2)))./(8.*a.^2 + 8) - 0.2500))./a
% f = @(x) (exp(- ((32.*x.^2 + 33).^(1/2) + 1).^2./(8.*x.^2 + 8).^2 - (x + x.*(32.*x.^2 + 33).^(1/2)).^2./(8.*x.^2 + 8).^2).*(exp(- ((32.*x.^2 + 33).^(1/2) + 1).^2./(8.*x.^2 + 8).^2 - (x + x.*(32.*x.^2 + 33).^(1/2)).^2./(8.*x.^2 + 8).^2).*((32.*x)./((8.*x.^2 + 8).*(32.*x.^2 + 33).^0.5000) + (x + x.*(32.*x.^2 + 33).^(1/2))./(8.*x.^2 + 8) - (16.*x.^2.*(x + x.*(32.*x.^2 + 33).^(1/2)))./(8.*x.^2 + 8).^2 + (x.*((32.*x.^2)./(32.*x.^2 + 33).^0.5000 + (32.*x.^2 + 33).^(1/2) + 1))./(8.*x.^2 + 8) - (16.*x*((32.*x.^2 + 33).^(1/2) + 1))./(8.*x.^2 + 8).^2) + exp(- ((32.*x.^2 + 33).^(1/2) + 1).^2./(8.*x.^2 + 8).^2 - (x + x.*(32.*x.^2 + 33).^(1/2)).^2./(8.*x.^2 + 8).^2).*(((32.*x.^2 + 33).^(1/2) + 1)./(8.*x.^2 + 8) + (x.*(x + x.*(32.*x.^2 + 33).^(1/2)))./(8.*x.^2 + 8) - 0.2500).*((32.*x.*((32.*x.^2 + 33).^(1/2) + 1).^2)./(8.*x.^2 + 8).^3 + (32.*x.*(x + x.*(32.*x.^2 + 33).^(1/2)).^2)./(8.*x.^2 + 8).^3 - (2.*(x + x.*(32.*x.^2 + 33).^(1/2)).*((32.*x.^2)./(32.*x.^2 + 33).^0.5000 + (32.*x.^2 + 33).^(1/2) + 1))./(8.*x.^2 + 8).^2 - (64.*x.*((32.*x.^2 + 33).^(1/2) + 1))./((8.*x.^2 + 8).^2.*(32.*x.^2 + 33).^0.5000))).*(((32.*x.^2 + 33).^(1/2) + 1)./(8.*x.^2 + 8) + (x.*(x + x.*(32.*x.^2 + 33).^(1/2)))./x

fa = f(x);
plot(x,fa,'-')

